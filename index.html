<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOT REAL SGO</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
    <script>
        // Firebase конфигурация
        const firebaseConfig = {
            apiKey: "AIzaSyCfII279Y-Np3by_EOAu37dUfYe7-APdZg",
            authDomain: "setevoigorod-7d5a8.firebaseapp.com",
            projectId: "setevoigorod-7d5a8",
            storageBucket: "setevoigorod-7d5a8.appspot.com",
            messagingSenderId: "777501181808",
            appId: "1:777501181808:web:2ed26464d7f4ad6c25b1b5",
            measurementId: "G-WNFHGTHGFS"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Вход для администратора
        function adminLogin() {
            const login = document.getElementById('login').value;
            const password = document.getElementById('password').value;

            if (login === "Cobaken555" && password === "Mazda371") {
                document.getElementById('grades-section').style.display = 'block';
                document.getElementById('save-btn').style.display = 'block';
                document.getElementById('login-form').style.display = 'none';
            } else {
                document.getElementById('login-status').innerText = 'Неверные данные!';
            }
        }

        // Вход как гость
        function guestLogin() {
            document.getElementById('grades-section').style.display = 'block';
            document.getElementById('save-btn').style.display = 'none';
            document.getElementById('login-form').style.display = 'none';
        }

        // Сохранение оценок и домашнего задания
        function saveGrades() {
            const inputs = document.querySelectorAll('input[type="text"]');
            const grades = {};

            inputs.forEach(input => {
                const name = input.getAttribute('data-name');
                const date = input.getAttribute('data-date');
                const value = input.value;

                if (!grades[name]) {
                    grades[name] = {};
                }
                grades[name][date] = value;

                db.collection("grades").doc(name).set(grades[name])
                    .then(() => {
                        displayStatus("Оценки и задания сохранены!", true);
                    })
                    .catch((error) => {
                        displayStatus("Ошибка при сохранении!", false);
                    });
            });
        }

        // Загрузка оценок и домашних заданий
        function loadGrades() {
            const inputs = document.querySelectorAll('input[type="text"]');

            inputs.forEach(input => {
                const name = input.getAttribute('data-name');
                const date = input.getAttribute('data-date');

                db.collection("grades").doc(name).get().then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        if (data[date]) {
                            input.value = data[date];
                        }
                    }
                });
            });
        }

        // Отображение статуса сохранения
        function displayStatus(message, success) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerText = message;
            statusDiv.style.color = success ? 'green' : 'red';
        }

        // Проверка вводимого значения в поле оценки
        function validateGradeInput(input) {
            const value = input.value;
            const isValid = value === '' || value === 'н' || value === 'Н' || (Number(value) >= 2 && Number(value) <= 5);

            if (!isValid) {
                input.style.border = '2px solid red';
                displayStatus("Введите правильную оценку (2-5) или н/Н!", false);
            } else {
                input.style.border = '';
                displayStatus("", true);
            }
        }

        // Загрузка при загрузке страницы
        window.onload = function() {
            loadGrades();
        };
    </script>
    <style>
        body {
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        #header {
            background-color: #0d6efd;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 24px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ccc;
        }
        input[type="text"] {
            width: 100%;
            padding: 5px;
        }
        #save-btn {
            background-color: #0d6efd;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
        }
        #save-btn:hover {
            background-color: #0a58ca;
        }
    </style>
</head>
<body>

<div id="header">NOT REAL SGO</div>

<!-- Логин для администратора -->
<div id="login-form">
    <h2>Вход для администратора</h2>
    <label for="login">Логин:</label>
    <input type="text" id="login"><br>
    <label for="password">Пароль:</label>
    <input type="password" id="password"><br>
    <button onclick="adminLogin()">Войти</button>
    <div id="login-status"></div>
    <button id="guest-btn" onclick="guestLogin()">Войти как гость</button>
</div>

<!-- Таблица оценок и домашнего задания -->
<div id="grades-section" style="display: none;">
    <table>
        <thead>
            <tr>
                <th>Имя Фамилия</th>
                <th>Домашнее задание (01.10.2024)</th>
                <th>Оценка (01.10.2024)</th>
                <th>Домашнее задание (02.10.2024)</th>
                <th>Оценка (02.10.2024)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Есаян Майя</td>
                <td><input type="text" data-name="esayan_maya" data-date="01.10.2024"></td>
                <td><input type="text" data-name="esayan_maya" data-date="grade_01.10.2024" oninput="validateGradeInput(this)"></td>
                <td><input type="text" data-name="esayan_maya" data-date="02.10.2024"></td>
                <td><input type="text" data-name="esayan_maya" data-date="grade_02.10.2024" oninput="validateGradeInput(this)"></td>
            </tr>
            <!-- Добавьте остальные строки для других учеников -->
        </tbody>
    </table>

    <button id="save-btn" onclick="saveGrades()">Сохранить оценки и задания</button>
    <div id="status"></div>
</div>

</body>
</html>
